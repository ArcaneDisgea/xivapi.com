var Dalamud=function(e){function t(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/ui/",t(t.s="eEhe")}({"4CL/":function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=n("pQPX"),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=function(){function e(){o(this,e),this.websocket=null}return r(e,[{key:"connect",value:function(e){var t=this;Swal.fire({title:"Connecting",text:"Please wait while we connect to the battle arena",allowOutsideClick:!1,allowEscapeKey:!1,onBeforeOpen:function(){Swal.showLoading()}}),console.log("Connecting to XIVAPI WebSocket"),this.websocket=new WebSocket("wss://xivapi.local/socket"),this.websocket.onopen=function(n){setTimeout(function(){Swal.close()},1e3),t.webSocketOnOpen(n),e()},this.websocket.onmessage=function(e){t.webSocketOnMessage(e)},this.websocket.onclose=function(e){Swal.fire({title:"Disconnected",text:"Lost connection to the battlegrounds",type:"error"}),t.webSocketOnDisconnect(e)},this.websocket.onerror=function(e){t.webSocketOnDisconnect(e)}}},{key:"webSocketOnOpen",value:function(){this.webSocketSendMessage("REGISTER_WEB_CLIENT")}},{key:"webSocketOnMessage",value:function(e){var t=JSON.parse(e.data);0!==t.ACTION.length&&a.a.handle(t)}},{key:"webSocketOnDisconnect",value:function(){console.log("disconnected")}},{key:"webSocketSendMessage",value:function(e,t){var n={APIKEY:APIKEY,SOURCE:"WEB",ACTION:e,DATA:t};this.websocket.send(JSON.stringify(n))}}]),e}();t.a=new s},"5rm/":function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=n("4CL/"),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=function(){function e(){o(this,e),this.room=null,this.renderedEnemyIds=[]}return r(e,[{key:"renderList",value:function(e){if(e&&Object.keys(e).length>0)return $(".battle_rooms").html(""),void Object.keys(e).forEach(function(t){var n=e[t];$(".battle_rooms").append('\n                    <button type="button" id="'+n.id+'" class="list-group-item list-group-item-action">'+n.name+"</li>\n                ")});$(".battle_rooms").append('\n            <li class="list-group-item">No battle rooms</li>\n        ')}},{key:"requestList",value:function(){a.a.webSocketSendMessage("LIST_ROOMS")}},{key:"create",value:function(e,t){a.a.webSocketSendMessage("CREATE_ROOM",{name:e,monsters:t.split(",")})}},{key:"join",value:function(e){a.a.webSocketSendMessage("JOIN_ROOM",e)}},{key:"load",value:function(e){this.room=e;var t=$(".room_view");$(".room_create, .room_view").removeClass("open"),t.addClass("open"),console.log(e),t.html("\n            <h2>("+e.number+") "+e.name+'</h2>\n            <hr>\n            <div class="monster_battles"></div>\n        ')}},{key:"mobdata",value:function(e){var t=$(".monster_battles");for(var n in e.monstersData){var o=e.monstersData[n];-1===this.renderedEnemyIds.indexOf(o.spawn_id)&&(this.renderedEnemyIds.push(o.spawn_id),this.renderMonsterBlock(o));var a=t.find("#"+o.spawn_id),r=o.hp/o.hp_max*100;a.find(".mob_bar").css("width",r+"%"),a.find(".mob_hp").text(o.hp)}console.log(e)}},{key:"renderMonsterBlock",value:function(e){$(".monster_battles").append('\n        <div id="'+e.spawn_id+'">\n            <p>Name: '+e.level+" "+e.name+' - <span class="mob_hp">'+e.hp+"</span>/"+e.hp_max+'</p>        \n            <div class="progress">\n                <div class="progress-bar bg-danger mob_bar" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>\n            </div>\n        </div>\n        ')}},{key:"removeSpawns",value:function(e){if(console.log(e),void 0!==e&&0!==e.length){var t=$(".monster_battles");for(var n in e){var o=e[n];t.find("#"+o).remove()}}}}]),e}();t.a=new s},IpgK:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=n("5rm/"),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=function(){function e(){o(this,e),this.createRoomMonsterIdList=[]}return r(e,[{key:"watch",value:function(){this.watchMenuForRoomCreate(),this.watchForMonsterSearch(),this.watchForMonsterSelection(),this.watchForCreateRoomFormSubmit(),this.watchForRoomSelection()}},{key:"watchMenuForRoomCreate",value:function(){$(".btn_create_room").on("click",function(e){$(".room_create, .room_view").removeClass("open"),$(".room_create").addClass("open")})}},{key:"watchForMonsterSearch",value:function(){$(".search_monster").on("click",function(e){var t=$(".monster_name").val().trim();$(".monster_list_search_results").html(""),$.ajax({url:"https://xivapi.com/search",data:{indexes:"bnpcname",string:t},success:function(e){e.Results.forEach(function(e){$(".monster_list_search_results").append('\n                            <button type="button" class="btn btn-outline-secondary monster_selected" id="'+e.ID+'">'+e.ID+" - "+e.Name+"</button>\n                        ")})},error:console.log})})}},{key:"watchForMonsterSelection",value:function(){var e=this;$(".monster_list_search_results").on("click",".btn",function(t){var n=$(t.target).attr("id");e.createRoomMonsterIdList.push(n),$(".monster_list").val(e.createRoomMonsterIdList.join(","))})}},{key:"watchForCreateRoomFormSubmit",value:function(){var e=this;$(".create_battle_room").on("click",function(t){var n=$(".room_name").val().trim(),o=$(".monster_list").val().trim();$(".room_name").val(""),$(".monster_list").val(""),$(".monster_list_search_results").html(""),e.createRoomMonsterIdList=[],a.a.create(n,o)})}},{key:"watchForRoomSelection",value:function(){$(".battle_rooms").on("click","button",function(e){var t=$(e.target).attr("id");console.log(t),a.a.join(t)})}},{key:"showAppStatusActivated",value:function(){$(".app_status").html('<span class="badge badge-success">Monitoring App Detected!</span>')}},{key:"showAppStatusDeactivated",value:function(){$(".app_player_name").html("-"),$(".app_status").html('<span class="badge badge-danger">App not connected</span>')}},{key:"showPlayerName",value:function(e){$(".app_player_name").html("<strong>"+e.player_name+"</strong>")}},{key:"showPlayerData",value:function(e){}}]),e}();t.a=new s},eEhe:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("4CL/"),a=n("IpgK"),r=n("5rm/");o.a.connect(function(){r.a.requestList(),a.a.watch()})},pQPX:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=n("5rm/"),r=n("IpgK"),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=function(){function e(){o(this,e)}return s(e,[{key:"handle",value:function(e){switch(e.ACTION){default:console.log("Unknown action: "+e.ACTION);break;case"REGISTER_APP_CLIENT":r.a.showAppStatusActivated();break;case"APP_DISCONNECTED":r.a.showAppStatusDeactivated();break;case"LIST_ROOMS":a.a.renderList(e.DATA);break;case"LOAD_ROOM":a.a.load(e.DATA);break;case"JOIN_ROOM":a.a.join(e.DATA);break;case"GAME_PLAYER_NAME":r.a.showPlayerName(e.DATA);break;case"GAME_PLAYER_DATA":r.a.showPlayerData(e.DATA);break;case"GAME_MOB_DATA":a.a.mobdata(e.DATA);break;case"GAME_MOB_REMOVE_SPAWNS":a.a.removeSpawns(e.DATA);break;case"GAME_MOB_DEAD":a.a.removeSpawns()}}}]),e}();t.a=new i}}).default;